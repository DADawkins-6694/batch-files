@echo off
setlocal enabledelayedexpansion

for /f "tokens=1-4 delims=/ " %%a in ("%date%") do (
    set mm=%%a
    set dd=%%b
    set yyyy=%%c
)
set hh=%time:~0,2%
set hh=%hh: =0%
set nn=%time:~3,2%
set ss=%time:~6,2%

set timestamp=%yyyy%-%mm%-%dd%_%hh%-%nn%-%ss%
set outfile=network_diagnostics_%timestamp%.txt

echo ============================================= > "%outfile%"
echo        NETWORK DIAGNOSTICS REPORT             >> "%outfile%"
echo ============================================= >> "%outfile%"
echo Report generated: %date% %time%              >> "%outfile%"
echo --------------------------------------------- >> "%outfile%"

echo COMPUTER NAME: %COMPUTERNAME% >> "%outfile%"
echo USER NAME: %USERNAME% >> "%outfile%"
echo OS VERSION: >> "%outfile%"
ver >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo IP CONFIGURATION (IPv4 / IPv6 / MAC) >> "%outfile%"
ipconfig /all >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo NETWORK INTERFACE SUMMARY >> "%outfile%"
netsh interface ipv4 show interfaces >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo DNS SERVER CONFIGURATION >> "%outfile%"
nslookup google.com >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo ROUTING TABLE >> "%outfile%"
route print >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo ARP TABLE >> "%outfile%"
arp -a >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo ACTIVE CONNECTIONS >> "%outfile%"
netstat -ano >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo WIRELESS INFORMATION >> "%outfile%"
netsh wlan show interfaces >> "%outfile%"
netsh wlan show networks >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo SAVED NETWORK PROFILES >> "%outfile%"
netsh wlan show profiles >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo SYSTEM HARDWARE INFO >> "%outfile%"
systeminfo >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo PING TEST (Google DNS) >> "%outfile%"
ping 8.8.8.8 -n 4 >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"
echo ========================================================================================== >> "%outfile%"
echo ------------------------------------------------------------------------------------------ >> "%outfile%"

echo Diagnostics complete!
echo Output saved to: %outfile%
powershell -NoProfile -STA -Command "Add-Type -AssemblyName System.Windows.Forms; [System.Windows.Forms.MessageBox]::Show('The network diagnostics report is complete. The output was saved to the folder containing this batch file.')"
endlocal
exit


